(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(a){
;var b=0,c=Array.prototype.slice;a.cleanData=(function(e){return function(g){var j,k,h;for(h=0;(k=g[h])!=null;h++){try{j=a._data(k,"events");if(j&&j.remove){a(k).triggerHandler("remove")}}catch(f){}}e(g)}})(a.cleanData);a.widget=function(e,f,m){var j,k,h,l,g={},i=e.split(".")[0];e=e.split(".")[1];j=i+"-"+e;if(!m){m=f;f=a.Widget}a.expr[":"][j.toLowerCase()]=function(n){return !!a.data(n,j)};a[i]=a[i]||{};k=a[i][e];h=a[i][e]=function(n,o){if(!this._createWidget){return new h(n,o)}if(arguments.length){this._createWidget(n,o)}};a.extend(h,k,{version:m.version,_proto:a.extend({},m),_childConstructors:[]});l=new f();l.options=a.widget.extend({},l.options);a.each(m,function(o,n){if(!a.isFunction(n)){g[o]=n;return}g[o]=(function(){var p=function(){return f.prototype[o].apply(this,arguments)},q=function(r){return f.prototype[o].apply(this,r)};return function(){var r=this._super,s=this._superApply,t;this._super=p;this._superApply=q;t=n.apply(this,arguments);this._super=r;this._superApply=s;return t}})()});h.prototype=a.widget.extend(l,{widgetEventPrefix:k?(l.widgetEventPrefix||e):e},g,{constructor:h,namespace:i,widgetName:e,widgetFullName:j});if(k){a.each(k._childConstructors,function(o,p){var n=p.prototype;a.widget(n.namespace+"."+n.widgetName,h,p._proto)});delete k._childConstructors}else{f._childConstructors.push(h)}a.widget.bridge(e,h);return h};a.widget.extend=function(g){var h=c.call(arguments,1),e=0,f=h.length,i,j;for(;e<f;e++){for(i in h[e]){j=h[e][i];if(h[e].hasOwnProperty(i)&&j!==undefined){if(a.isPlainObject(j)){g[i]=a.isPlainObject(g[i])?a.widget.extend({},g[i],j):a.widget.extend({},j)}else{g[i]=j}}}}return g};a.widget.bridge=function(e,g){var f=g.prototype.widgetFullName||e;a.fn[e]=function(i){var k=typeof i==="string",h=c.call(arguments,1),j=this;i=!k&&h.length?a.widget.extend.apply(null,[i].concat(h)):i;if(k){this.each(function(){var m,l=a.data(this,f);if(i==="instance"){j=l;return false}if(!l){return a.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+i+"'")}if(!a.isFunction(l[i])||i.charAt(0)==="_"){return a.error("no such method '"+i+"' for "+e+" widget instance")}m=l[i].apply(l,h);if(m!==l&&m!==undefined){j=m&&m.jquery?j.pushStack(m.get()):m;return false}})}else{this.each(function(){var l=a.data(this,f);if(l){l.option(i||{});if(l._init){l._init()}}else{a.data(this,f,new g(i,this))}})}return j}};a.Widget=function(){};a.Widget._childConstructors=[];a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(e,f){f=a(f||this.defaultElement||this)[0];this.element=a(f);this.uuid=b++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=a.widget.extend({},this.options,this._getCreateOptions(),e);this.bindings=a();this.hoverable=a();this.focusable=a();if(f!==this){a.data(f,this.widgetFullName,this);this._on(true,this.element,{remove:function(g){if(g.target===f){this.destroy()}}});this.document=a(f.style?f.ownerDocument:f.document||f);this.window=a(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(k,e){var g=k,f,j,h;if(arguments.length===0){return a.widget.extend({},this.options)}if(typeof k==="string"){g={};f=k.split(".");k=f.shift();if(f.length){j=g[k]=a.widget.extend({},this.options[k]);for(h=0;h<f.length-1;h++){j[f[h]]=j[f[h]]||{};j=j[f[h]]}k=f.pop();if(arguments.length===1){return j[k]===undefined?null:j[k]}j[k]=e}else{if(arguments.length===1){return this.options[k]===undefined?null:this.options[k]}g[k]=e}}this._setOptions(g);return this},_setOptions:function(e){var f;for(f in e){this._setOption(f,e[f])}return this},_setOption:function(e,f){this.options[e]=f;if(e==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!f);if(f){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_on:function(e,i,h){var f,g=this;if(typeof e!=="boolean"){h=i;i=e;e=false}if(!h){h=i;i=this.element;f=this.widget()}else{i=f=a(i);this.bindings=this.bindings.add(i)}a.each(h,function(l,k){function o(){if(!e&&(g.options.disabled===true||a(this).hasClass("ui-state-disabled"))){return}return(typeof k==="string"?g[k]:k).apply(g,arguments)}if(typeof k!=="string"){o.guid=k.guid=k.guid||o.guid||a.guid++}var j=l.match(/^([\w:-]*)\s*(.*)$/),n=j[1]+g.eventNamespace,m=j[2];if(m){f.delegate(m,n,o)}else{i.bind(n,o)}})},_off:function(f,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;f.unbind(e).undelegate(e)},_delay:function(f,e){function h(){return(typeof f==="string"?g[f]:f).apply(g,arguments)}var g=this;return setTimeout(h,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e);this._on(e,{mouseenter:function(f){a(f.currentTarget).addClass("ui-state-hover")},mouseleave:function(f){a(f.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e);this._on(e,{focusin:function(f){a(f.currentTarget).addClass("ui-state-focus")},focusout:function(f){a(f.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(g,h,i){var f,e,j=this.options[g];i=i||{};h=a.Event(h);h.type=(g===this.widgetEventPrefix?g:this.widgetEventPrefix+g).toLowerCase();h.target=this.element[0];e=h.originalEvent;if(e){for(f in e){if(!(f in h)){h[f]=e[f]}}}this.element.trigger(h,i);return !(a.isFunction(j)&&j.apply(this.element[0],[h].concat(i))===false||h.isDefaultPrevented())}};a.each({show:"fadeIn",hide:"fadeOut"},function(f,e){a.Widget.prototype["_"+f]=function(h,g,k){if(typeof g==="string"){g={effect:g}}var i,j=!g?f:g===true||typeof g==="number"?e:g.effect||e;g=g||{};if(typeof g==="number"){g={duration:g}}i=!a.isEmptyObject(g);g.complete=k;if(g.delay){h.delay(g.delay)}if(i&&a.effects&&a.effects.effect[j]){h[f](g)}else{if(j!==f&&h[j]){h[j](g.duration,g.easing,k)}else{h.queue(function(l){a(this)[f]();if(k){k.call(h[0])}l()})}}}});var d=a.widget}));
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(window.jQuery)}}(function(b){var a=0;b.ajaxTransport("iframe",function(f){if(f.async){var e=f.initialIframeSrc||"javascript:false;",c,g,d;return{send:function(h,i){c=b('<form style="display:none;"></form>');c.attr("accept-charset",f.formAcceptCharset);d=/\?/.test(f.url)?"&":"?";if(f.type==="DELETE"){f.url=f.url+d+"_method=DELETE";f.type="POST"}else{if(f.type==="PUT"){f.url=f.url+d+"_method=PUT";f.type="POST"}else{if(f.type==="PATCH"){f.url=f.url+d+"_method=PATCH";f.type="POST"}}}a+=1;g=b('<iframe src="'+e+'" name="iframe-transport-'+a+'"></iframe>').bind("load",function(){var j,k=b.isArray(f.paramName)?f.paramName:[f.paramName];g.unbind("load").bind("load",function(){var m;try{m=g.contents();if(!m.length||!m[0].firstChild){throw new Error()}}catch(l){m=undefined}i(200,"success",{iframe:m});b('<iframe src="'+e+'"></iframe>').appendTo(c);window.setTimeout(function(){c.remove()},0)});c.prop("target",g.prop("name")).prop("action",f.url).prop("method",f.type);if(f.formData){b.each(f.formData,function(m,l){b('<input type="hidden"/>').prop("name",l.name).val(l.value).appendTo(c)})}if(f.fileInput&&f.fileInput.length&&f.type==="POST"){j=f.fileInput.clone();f.fileInput.after(function(l){return j[l]});if(f.paramName){f.fileInput.each(function(l){b(this).prop("name",k[l]||f.paramName)})}c.append(f.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data");f.fileInput.removeAttr("form")}c.submit();if(j&&j.length){f.fileInput.each(function(l,n){var m=b(j[l]);b(n).prop("name",m.prop("name")).attr("form",m.attr("form"));m.replaceWith(n)})}});c.append(g).appendTo(document.body)},abort:function(){if(g){g.unbind("load").prop("src",e)}if(c){c.remove()}}}}});b.ajaxSetup({converters:{"iframe text":function(c){return c&&b(c[0].body).text()},"iframe json":function(c){return c&&b.parseJSON(b(c[0].body).text())},"iframe html":function(c){return c&&b(c[0].body).html()},"iframe xml":function(c){var d=c&&c[0];return d&&b.isXMLDoc(d)?d:b.parseXML((d.XMLDocument&&d.XMLDocument.xml)||b(d.body).html())},"iframe script":function(c){return c&&b.globalEval(b(c[0].body).text())}}})}));
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","jquery.ui.widget"],a)}else{a(window.jQuery)}}(function(b){b.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||b('<input type="file">').prop("disabled"));b.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);b.support.xhrFormDataFileUpload=!!window.FormData;b.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);function a(c){var d=c==="dragover";return function(g){g.dataTransfer=g.originalEvent&&g.originalEvent.dataTransfer;var f=g.dataTransfer;if(f&&b.inArray("Files",f.types)!==-1&&this._trigger(c,b.Event(c,{delegatedEvent:g}))!==false){g.preventDefault();if(d){f.dropEffect="copy"}}}}b.widget("blueimp.fileupload",{options:{dropZone:b(document),pasteZone:undefined,fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(d,c){d=this.messages[d]||d.toString();if(c){b.each(c,function(e,f){d=d.replace("{"+e+"}",f)})}return d},formData:function(c){return c.serializeArray()},add:function(d,c){if(d.isDefaultPrevented()){return false}if(c.autoUpload||(c.autoUpload!==false&&b(this).fileupload("option","autoUpload"))){c.process().done(function(){c.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:b.support.blobSlice&&function(){var c=this.slice||this.webkitSlice||this.mozSlice;return c.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=((Date.now)?Date.now():(new Date()).getTime());this.loaded=0;this.bitrate=0;this.getBitrate=function(c,f,e){var d=c-this.timestamp;if(!this.bitrate||!e||d>e){this.bitrate=(f-this.loaded)*(1000/d)*8;this.loaded=f;this.timestamp=c}return this.bitrate}},_isXHRUpload:function(c){return !c.forceIframeTransport&&((!c.multipart&&b.support.xhrFileUpload)||b.support.xhrFormDataFileUpload)},_getFormData:function(c){var d;if(b.type(c.formData)==="function"){return c.formData(c.form)}if(b.isArray(c.formData)){return c.formData}if(b.type(c.formData)==="object"){d=[];b.each(c.formData,function(e,f){d.push({name:e,value:f})});return d}return[]},_getTotal:function(d){var c=0;b.each(d,function(e,f){c+=f.size||1});return c},_initProgressObject:function(d){var c={loaded:0,total:0,bitrate:0};if(d._progress){b.extend(d._progress,c)}else{d._progress=c}},_initResponseObject:function(c){var d;if(c._response){for(d in c._response){if(c._response.hasOwnProperty(d)){delete c._response[d]}}}else{c._response={}}},_onProgress:function(d,c){if(d.lengthComputable){var g=((Date.now)?Date.now():(new Date()).getTime()),f;if(c._time&&c.progressInterval&&(g-c._time<c.progressInterval)&&d.loaded!==d.total){return}c._time=g;f=Math.floor(d.loaded/d.total*(c.chunkSize||c._progress.total))+(c.uploadedBytes||0);this._progress.loaded+=(f-c._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(g,this._progress.loaded,c.bitrateInterval);c._progress.loaded=c.loaded=f;c._progress.bitrate=c.bitrate=c._bitrateTimer.getBitrate(g,f,c.bitrateInterval);this._trigger("progress",b.Event("progress",{delegatedEvent:d}),c);this._trigger("progressall",b.Event("progressall",{delegatedEvent:d}),this._progress)}},_initProgressListener:function(e){var c=this,d=e.xhr?e.xhr():b.ajaxSettings.xhr();if(d.upload){b(d.upload).bind("progress",function(f){var g=f.originalEvent;f.lengthComputable=g.lengthComputable;f.loaded=g.loaded;f.total=g.total;c._onProgress(f,e)});e.xhr=function(){return d}}},_isInstanceOf:function(c,d){return Object.prototype.toString.call(d)==="[object "+c+"]"},_initXHRData:function(f){var h=this,e,g=f.files[0],d=f.multipart||!b.support.xhrFileUpload,c=b.type(f.paramName)==="array"?f.paramName[0]:f.paramName;f.headers=b.extend({},f.headers);if(f.contentRange){f.headers["Content-Range"]=f.contentRange}if(!d||f.blob||!this._isInstanceOf("File",g)){f.headers["Content-Disposition"]='attachment; filename="'+encodeURI(g.name)+'"'}if(!d){f.contentType=g.type||"application/octet-stream";f.data=f.blob||g}else{if(b.support.xhrFormDataFileUpload){if(f.postMessage){e=this._getFormData(f);if(f.blob){e.push({name:c,value:f.blob})}else{b.each(f.files,function(i,j){e.push({name:(b.type(f.paramName)==="array"&&f.paramName[i])||c,value:j})})}}else{if(h._isInstanceOf("FormData",f.formData)){e=f.formData}else{e=new FormData();b.each(this._getFormData(f),function(i,j){e.append(j.name,j.value)})}if(f.blob){e.append(c,f.blob,g.name)}else{b.each(f.files,function(i,j){if(h._isInstanceOf("File",j)||h._isInstanceOf("Blob",j)){e.append((b.type(f.paramName)==="array"&&f.paramName[i])||c,j,j.uploadName||j.name)}})}}f.data=e}}f.blob=null},_initIframeSettings:function(c){var d=b("<a></a>").prop("href",c.url).prop("host");c.dataType="iframe "+(c.dataType||"");c.formData=this._getFormData(c);if(c.redirect&&d&&d!==location.host){c.formData.push({name:c.redirectParamName||"redirect",value:c.redirect})}},_initDataSettings:function(c){if(this._isXHRUpload(c)){if(!this._chunkedUpload(c,true)){if(!c.data){this._initXHRData(c)}this._initProgressListener(c)}if(c.postMessage){c.dataType="postmessage "+(c.dataType||"")}}else{this._initIframeSettings(c)}},_getParamName:function(e){var c=b(e.fileInput),d=e.paramName;if(!d){d=[];c.each(function(){var f=b(this),g=f.prop("name")||"files[]",h=(f.prop("files")||[1]).length;while(h){d.push(g);h-=1}});if(!d.length){d=[c.prop("name")||"files[]"]}}else{if(!b.isArray(d)){d=[d]}}return d},_initFormSettings:function(c){if(!c.form||!c.form.length){c.form=b(c.fileInput.prop("form"));if(!c.form.length){c.form=b(this.options.fileInput.prop("form"))}}c.paramName=this._getParamName(c);if(!c.url){c.url=c.form.prop("action")||location.href}c.type=(c.type||(b.type(c.form.prop("method"))==="string"&&c.form.prop("method"))||"").toUpperCase();if(c.type!=="POST"&&c.type!=="PUT"&&c.type!=="PATCH"){c.type="POST"}if(!c.formAcceptCharset){c.formAcceptCharset=c.form.attr("accept-charset")}},_getAJAXSettings:function(d){var c=b.extend({},this.options,d);this._initFormSettings(c);this._initDataSettings(c);return c},_getDeferredState:function(c){if(c.state){return c.state()}if(c.isResolved()){return"resolved"}if(c.isRejected()){return"rejected"}return"pending"},_enhancePromise:function(c){c.success=c.done;c.error=c.fail;c.complete=c.always;return c},_getXHRPromise:function(c,g,f){var e=b.Deferred(),d=e.promise();g=g||this.options.context||d;if(c===true){e.resolveWith(g,f)}else{if(c===false){e.rejectWith(g,f)}}d.abort=e.promise;return this._enhancePromise(d)},_addConvenienceMethods:function(d,c){var g=this,f=function(e){return b.Deferred().resolveWith(g,e).promise()};c.process=function(h,e){if(h||e){c._processQueue=this._processQueue=(this._processQueue||f([this])).pipe(function(){if(c.errorThrown){return b.Deferred().rejectWith(g,[c]).promise()}return f(arguments)}).pipe(h,e)}return this._processQueue||f([this])};c.submit=function(){if(this.state()!=="pending"){c.jqXHR=this.jqXHR=(g._trigger("submit",b.Event("submit",{delegatedEvent:d}),this)!==false)&&g._onSend(d,this)}return this.jqXHR||g._getXHRPromise()};c.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}this.errorThrown="abort";g._trigger("fail",null,this);return g._getXHRPromise(false)};c.state=function(){if(this.jqXHR){return g._getDeferredState(this.jqXHR)}if(this._processQueue){return g._getDeferredState(this._processQueue)}};c.processing=function(){return !this.jqXHR&&this._processQueue&&g._getDeferredState(this._processQueue)==="pending"};c.progress=function(){return this._progress};c.response=function(){return this._response}},_getUploadedBytes:function(c){var e=c.getResponseHeader("Range"),d=e&&e.split("-"),f=d&&d.length>1&&parseInt(d[1],10);return f&&f+1},_chunkedUpload:function(h,n){h.uploadedBytes=h.uploadedBytes||0;var m=this,k=h.files[0],l=k.size,i=h.uploadedBytes,j=h.maxChunkSize||l,d=this._blobSlice,e=b.Deferred(),g=e.promise(),c,f;if(!(this._isXHRUpload(h)&&d&&(i||j<l))||h.data){return false}if(n){return true}if(i>=l){k.error=h.i18n("uploadedBytes");return this._getXHRPromise(false,h.context,[null,"error",k.error])}f=function(){var p=b.extend({},h),o=p._progress.loaded;p.blob=d.call(k,i,i+j,k.type);p.chunkSize=p.blob.size;p.contentRange="bytes "+i+"-"+(i+p.chunkSize-1)+"/"+l;m._initXHRData(p);m._initProgressListener(p);c=((m._trigger("chunksend",null,p)!==false&&b.ajax(p))||m._getXHRPromise(false,p.context)).done(function(q,s,r){i=m._getUploadedBytes(r)||(i+p.chunkSize);if(o+p.chunkSize-p._progress.loaded){m._onProgress(b.Event("progress",{lengthComputable:true,loaded:i-p.uploadedBytes,total:i-p.uploadedBytes}),p)}h.uploadedBytes=p.uploadedBytes=i;p.result=q;p.textStatus=s;p.jqXHR=r;m._trigger("chunkdone",null,p);m._trigger("chunkalways",null,p);if(i<l){f()}else{e.resolveWith(p.context,[q,s,r])}}).fail(function(q,s,r){p.jqXHR=q;p.textStatus=s;p.errorThrown=r;m._trigger("chunkfail",null,p);m._trigger("chunkalways",null,p);e.rejectWith(p.context,[q,s,r])})};this._enhancePromise(g);g.abort=function(){return c.abort()};f();return g},_beforeSend:function(d,c){if(this._active===0){this._trigger("start");this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(c);this._initProgressObject(c);c._progress.loaded=c.loaded=c.uploadedBytes||0;c._progress.total=c.total=this._getTotal(c.files)||1;c._progress.bitrate=c.bitrate=0;this._active+=1;this._progress.loaded+=c.loaded;this._progress.total+=c.total},_onDone:function(e,d,c,g){var h=g._progress.total,f=g._response;if(g._progress.loaded<h){this._onProgress(b.Event("progress",{lengthComputable:true,loaded:h,total:h}),g)}f.result=g.result=e;f.textStatus=g.textStatus=d;f.jqXHR=g.jqXHR=c;this._trigger("done",null,g)},_onFail:function(g,d,c,f){var e=f._response;if(f.recalculateProgress){this._progress.loaded-=f._progress.loaded;this._progress.total-=f._progress.total}e.jqXHR=f.jqXHR=g;e.textStatus=f.textStatus=d;e.errorThrown=f.errorThrown=c;this._trigger("fail",null,f)},_onAlways:function(c,d,f,e){this._trigger("always",null,e)},_onSend:function(i,g){if(!g.submit){this._addConvenienceMethods(i,g)}var h=this,k,c,j,d,l=h._getAJAXSettings(g),f=function(){h._sending+=1;l._bitrateTimer=new h._BitrateTimer();k=k||(((c||h._trigger("send",b.Event("send",{delegatedEvent:i}),l)===false)&&h._getXHRPromise(false,l.context,c))||h._chunkedUpload(l)||b.ajax(l)).done(function(m,e,n){h._onDone(m,e,n,l)}).fail(function(m,e,n){h._onFail(m,e,n,l)}).always(function(e,m,o){h._onAlways(e,m,o,l);h._sending-=1;h._active-=1;if(l.limitConcurrentUploads&&l.limitConcurrentUploads>h._sending){var n=h._slots.shift();while(n){if(h._getDeferredState(n)==="pending"){n.resolve();break}n=h._slots.shift()}}if(h._active===0){h._trigger("stop")}});return k};this._beforeSend(i,l);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){j=b.Deferred();this._slots.push(j);d=j.pipe(f)}else{this._sequence=this._sequence.pipe(f,f);d=this._sequence}d.abort=function(){c=[undefined,"abort","abort"];if(!k){if(j){j.rejectWith(l.context,c)}return f()}return k.abort()};return this._enhancePromise(d)}return f()},_onAdd:function(o,r){var l=this,v=true,u=b.extend({},this.options,r),f=r.files,s=f.length,g=u.limitMultiFileUploads,n=u.limitMultiFileUploadSize,t=u.limitMultiFileUploadSizeOverhead,k=0,h=this._getParamName(u),d,c,q,p,m=0;if(n&&(!s||f[0].size===undefined)){n=undefined}if(!(u.singleFileUploads||g||n)||!this._isXHRUpload(u)){q=[f];d=[h]}else{if(!(u.singleFileUploads||n)&&g){q=[];d=[];for(p=0;p<s;p+=g){q.push(f.slice(p,p+g));c=h.slice(p,p+g);if(!c.length){c=h}d.push(c)}}else{if(!u.singleFileUploads&&n){q=[];d=[];for(p=0;p<s;p=p+1){k+=f[p].size+t;if(p+1===s||((k+f[p+1].size+t)>n)||(g&&p+1-m>=g)){q.push(f.slice(m,p+1));c=h.slice(m,p+1);if(!c.length){c=h}d.push(c);m=p+1;k=0}}}else{d=h}}}r.originalFiles=f;b.each(q||f,function(e,i){var j=b.extend({},r);j.files=q?i:[i];j.paramName=d[e];l._initResponseObject(j);l._initProgressObject(j);l._addConvenienceMethods(o,j);v=l._trigger("add",b.Event("add",{delegatedEvent:o}),j);return v});return v},_replaceFileInput:function(d){var e=d.fileInput,c=e.clone(true);d.fileInputClone=c;b("<form></form>").append(c)[0].reset();e.after(c).detach();b.cleanData(e.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(f,g){if(g===e[0]){return c[0]}return g});if(e[0]===this.element[0]){this.element=c}},_handleFileTreeEntry:function(h,j){var e=this,i=b.Deferred(),d=function(l){if(l&&!l.entry){l.entry=h}i.resolve([l])},f=function(l){e._handleFileTreeEntries(l,j+h.name+"/").done(function(m){i.resolve(m)}).fail(d)},g=function(){k.readEntries(function(l){if(!l.length){f(c)}else{c=c.concat(l);g()}},d)},k,c=[];j=j||"";if(h.isFile){if(h._file){h._file.relativePath=j;i.resolve(h._file)}else{h.file(function(l){l.relativePath=j;i.resolve(l)},d)}}else{if(h.isDirectory){k=h.createReader();g()}else{i.resolve([])}}return i.promise()},_handleFileTreeEntries:function(e,d){var c=this;return b.when.apply(b,b.map(e,function(f){return c._handleFileTreeEntry(f,d)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(d){d=d||{};var c=d.items;if(c&&c.length&&(c[0].webkitGetAsEntry||c[0].getAsEntry)){return this._handleFileTreeEntries(b.map(c,function(f){var e;if(f.webkitGetAsEntry){e=f.webkitGetAsEntry();if(e){e._file=f.getAsFile()}return e}return f.getAsEntry()}))}return b.Deferred().resolve(b.makeArray(d.files)).promise()},_getSingleFileInputFiles:function(c){c=b(c);var e=c.prop("webkitEntries")||c.prop("entries"),f,d;if(e&&e.length){return this._handleFileTreeEntries(e)}f=b.makeArray(c.prop("files"));if(!f.length){d=c.prop("value");if(!d){return b.Deferred().resolve([]).promise()}f=[{name:d.replace(/^.*\\/,"")}]}else{if(f[0].name===undefined&&f[0].fileName){b.each(f,function(g,h){h.name=h.fileName;h.size=h.fileSize})}}return b.Deferred().resolve(f).promise()},_getFileInputFiles:function(c){if(!(c instanceof b)||c.length===1){return this._getSingleFileInputFiles(c)}return b.when.apply(b,b.map(c,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(d){var f=this,c={fileInput:b(d.target),form:b(d.target.form)};this._getFileInputFiles(c.fileInput).always(function(e){c.files=e;if(f.options.replaceFileInput){f._replaceFileInput(c)}if(f._trigger("change",b.Event("change",{delegatedEvent:d}),c)!==false){f._onAdd(d,c)}})},_onPaste:function(d){var f=d.originalEvent&&d.originalEvent.clipboardData&&d.originalEvent.clipboardData.items,c={files:[]};if(f&&f.length){b.each(f,function(e,h){var g=h.getAsFile&&h.getAsFile();if(g){c.files.push(g)}});if(this._trigger("paste",b.Event("paste",{delegatedEvent:d}),c)!==false){this._onAdd(d,c)}}},_onDrop:function(d){d.dataTransfer=d.originalEvent&&d.originalEvent.dataTransfer;var f=this,c=d.dataTransfer,g={};if(c&&c.files&&c.files.length){d.preventDefault();this._getDroppedFiles(c).always(function(e){g.files=e;if(f._trigger("drop",b.Event("drop",{delegatedEvent:d}),g)!==false){f._onAdd(d,g)}})}},_onDragOver:a("dragover"),_onDragEnter:a("dragenter"),_onDragLeave:a("dragleave"),_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave});this._on(this.options.pasteZone,{paste:this._onPaste})}if(b.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(e,c){var d=b.inArray(e,this._specialOptions)!==-1;if(d){this._destroyEventHandlers()}this._super(e,c);if(d){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var c=this.options;if(c.fileInput===undefined){c.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]')}else{if(!(c.fileInput instanceof b)){c.fileInput=b(c.fileInput)}}if(!(c.dropZone instanceof b)){c.dropZone=b(c.dropZone)}if(!(c.pasteZone instanceof b)){c.pasteZone=b(c.pasteZone)}},_getRegExp:function(d){var c=d.split("/"),e=c.pop();c.shift();return new RegExp(c.join("/"),e)},_isRegExpOption:function(c,d){return c!=="url"&&b.type(d)==="string"&&/^\/.*\/[igm]{0,3}$/.test(d)},_initDataAttributes:function(){var c=this,e=this.options,d=b(this.element[0].cloneNode(false));b.each(d.data(),function(f,g){var h="data-"+f.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();if(d.attr(h)){if(c._isRegExpOption(f,g)){g=c._getRegExp(g)}e[f]=g}})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(d){var c=this;if(!d||this.options.disabled){return}if(d.fileInput&&!d.files){this._getFileInputFiles(d.fileInput).always(function(e){d.files=e;c._onAdd(null,d)})}else{d.files=b.makeArray(d.files);this._onAdd(null,d)}},send:function(c){if(c&&!this.options.disabled){if(c.fileInput&&!c.files){var g=this,e=b.Deferred(),d=e.promise(),f,h;d.abort=function(){h=true;if(f){return f.abort()}e.reject(null,"abort","abort");return d};this._getFileInputFiles(c.fileInput).always(function(i){if(h){return}if(!i.length){e.reject();return}c.files=i;f=g._onSend(null,c);f.then(function(j,l,k){e.resolve(j,l,k)},function(j,l,k){e.reject(j,l,k)})});return this._enhancePromise(d)}c.files=b.makeArray(c.files);if(c.files.length){return this._onSend(null,c)}}return this._getXHRPromise(false,c&&c.context)}})}));
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fileupload"],a)}else{a(window.jQuery)}}(function(a){var b=a.blueimp.fileupload.prototype.options.add;a.widget("blueimp.fileupload",a.blueimp.fileupload,{options:{processQueue:[],add:function(d,f){var c=a(this);f.process(function(){return c.fileupload("process",f)});b.call(this,d,f)}},processActions:{},_processFile:function(d,c){var g=this,e=a.Deferred().resolveWith(g,[d]),f=e.promise();this._trigger("process",null,d);a.each(d.processQueue,function(h,i){var j=function(l){if(c.errorThrown){return a.Deferred().rejectWith(g,[c]).promise()}return g.processActions[i.action].call(g,l,i)};f=f.pipe(j,i.always&&j)});f.done(function(){g._trigger("processdone",null,d);g._trigger("processalways",null,d)}).fail(function(){g._trigger("processfail",null,d);g._trigger("processalways",null,d)});return f},_transformProcessQueue:function(c){var d=[];a.each(c.processQueue,function(){var e={},g=this.action,f=this.prefix===true?g:this.prefix;a.each(this,function(h,i){if(a.type(i)==="string"&&i.charAt(0)==="@"){e[h]=c[i.slice(1)||(f?f+h.charAt(0).toUpperCase()+h.slice(1):h)]}else{e[h]=i}});d.push(e)});c.processQueue=d},processing:function(){return this._processing},process:function(d){var c=this,e=a.extend({},this.options,d);if(e.processQueue&&e.processQueue.length){this._transformProcessQueue(e);if(this._processing===0){this._trigger("processstart")}a.each(d.files,function(f){var h=f?a.extend({},e):e,g=function(){if(d.errorThrown){return a.Deferred().rejectWith(c,[d]).promise()}return c._processFile(h,d)};h.index=f;c._processing+=1;c._processingQueue=c._processingQueue.pipe(g,g).always(function(){c._processing-=1;if(c._processing===0){c._trigger("processstop")}})})}return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=a.Deferred().resolveWith(this).promise()}})}));
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","tmpl","./jquery.fileupload-image","./jquery.fileupload-audio","./jquery.fileupload-video","./jquery.fileupload-validate"],a)}else{a(window.jQuery,window.tmpl)}}(function(b,a){b.blueimp.fileupload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId");b.widget("blueimp.fileupload",b.blueimp.fileupload,{options:{autoUpload:false,uploadTemplateId:"template-upload",downloadTemplateId:"template-download",filesContainer:undefined,prependFiles:false,dataType:"json",messages:{unknownError:"Unknown error"},getNumberOfFiles:function(){return this.filesContainer.children().not(".processing").length},getFilesFromResponse:function(c){if(c.result&&b.isArray(c.result.files)){return c.result.files}return[]},add:function(d,h){if(d.isDefaultPrevented()){return false}var c=b(this),g=c.data("blueimp-fileupload")||c.data("fileupload"),f=g.options;h.context=g._renderUpload(h.files).data("data",h).addClass("processing");f.filesContainer[f.prependFiles?"prepend":"append"](h.context);g._forceReflow(h.context);g._transition(h.context);h.process(function(){return c.fileupload("process",h)}).always(function(){h.context.each(function(e){b(this).find(".size").text(g._formatFileSize(h.files[e].size))}).removeClass("processing");g._renderPreviews(h)}).done(function(){h.context.find(".start").prop("disabled",false);if((g._trigger("added",d,h)!==false)&&(f.autoUpload||h.autoUpload)&&h.autoUpload!==false){h.submit()}}).fail(function(){if(h.files.error){h.context.each(function(i){var e=h.files[i].error;if(e){b(this).find(".error").text(e)}})}})},send:function(d,c){if(d.isDefaultPrevented()){return false}var f=b(this).data("blueimp-fileupload")||b(this).data("fileupload");if(c.context&&c.dataType&&c.dataType.substr(0,6)==="iframe"){c.context.find(".progress").addClass(!b.support.transition&&"progress-animated").attr("aria-valuenow",100).children().first().css("width","100%")}return f._trigger("sent",d,c)},done:function(g,d){if(g.isDefaultPrevented()){return false}var i=b(this).data("blueimp-fileupload")||b(this).data("fileupload"),c=d.getFilesFromResponse||i.options.getFilesFromResponse,h=c(d),f,j;if(d.context){d.context.each(function(e){var k=h[e]||{error:"Empty file upload result"};j=i._addFinishedDeferreds();i._transition(b(this)).done(function(){var l=b(this);f=i._renderDownload([k]).replaceAll(l);i._forceReflow(f);i._transition(f).done(function(){d.context=b(this);i._trigger("completed",g,d);i._trigger("finished",g,d);j.resolve()})})})}else{f=i._renderDownload(h)[i.options.prependFiles?"prependTo":"appendTo"](i.options.filesContainer);i._forceReflow(f);j=i._addFinishedDeferreds();i._transition(f).done(function(){d.context=b(this);i._trigger("completed",g,d);i._trigger("finished",g,d);j.resolve()})}},fail:function(d,c){if(d.isDefaultPrevented()){return false}var h=b(this).data("blueimp-fileupload")||b(this).data("fileupload"),g,f;if(c.context){c.context.each(function(e){if(c.errorThrown!=="abort"){var i=c.files[e];i.error=i.error||c.errorThrown||c.i18n("unknownError");f=h._addFinishedDeferreds();h._transition(b(this)).done(function(){var j=b(this);g=h._renderDownload([i]).replaceAll(j);h._forceReflow(g);h._transition(g).done(function(){c.context=b(this);h._trigger("failed",d,c);h._trigger("finished",d,c);f.resolve()})})}else{f=h._addFinishedDeferreds();h._transition(b(this)).done(function(){b(this).remove();h._trigger("failed",d,c);h._trigger("finished",d,c);f.resolve()})}})}else{if(c.errorThrown!=="abort"){c.context=h._renderUpload(c.files)[h.options.prependFiles?"prependTo":"appendTo"](h.options.filesContainer).data("data",c);h._forceReflow(c.context);f=h._addFinishedDeferreds();h._transition(c.context).done(function(){c.context=b(this);h._trigger("failed",d,c);h._trigger("finished",d,c);f.resolve()})}else{h._trigger("failed",d,c);h._trigger("finished",d,c);h._addFinishedDeferreds().resolve()}}},progress:function(d,c){if(d.isDefaultPrevented()){return false}var f=Math.floor(c.loaded/c.total*100);if(c.context){c.context.each(function(){b(this).find(".progress").attr("aria-valuenow",f).children().first().css("width",f+"%")})}},progressall:function(c,h){if(c.isDefaultPrevented()){return false}var i=b(this),g=Math.floor(h.loaded/h.total*100),f=i.find(".fileupload-progress"),d=f.find(".progress-extended");if(d.length){d.html((i.data("blueimp-fileupload")||i.data("fileupload"))._renderExtendedProgress(h))}f.find(".progress").attr("aria-valuenow",g).children().first().css("width",g+"%")},start:function(d){if(d.isDefaultPrevented()){return false}var c=b(this).data("blueimp-fileupload")||b(this).data("fileupload");c._resetFinishedDeferreds();c._transition(b(this).find(".fileupload-progress")).done(function(){c._trigger("started",d)})},stop:function(d){if(d.isDefaultPrevented()){return false}var c=b(this).data("blueimp-fileupload")||b(this).data("fileupload"),f=c._addFinishedDeferreds();b.when.apply(b,c._getFinishedDeferreds()).done(function(){c._trigger("stopped",d)});c._transition(b(this).find(".fileupload-progress")).done(function(){b(this).find(".progress").attr("aria-valuenow","0").children().first().css("width","0%");b(this).find(".progress-extended").html("&nbsp;");f.resolve()})},processstart:function(c){if(c.isDefaultPrevented()){return false}b(this).addClass("fileupload-processing")},processstop:function(c){if(c.isDefaultPrevented()){return false}b(this).removeClass("fileupload-processing")},destroy:function(c,g){if(c.isDefaultPrevented()){return false}var f=b(this).data("blueimp-fileupload")||b(this).data("fileupload"),d=function(){f._transition(g.context).done(function(){b(this).remove();f._trigger("destroyed",c,g)})};if(g.url){g.dataType=g.dataType||f.options.dataType;b.ajax(g).done(d).fail(function(){f._trigger("destroyfailed",c,g)})}else{d()}}},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(c){if(!c){c=b.Deferred()}this._finishedUploads.push(c);return c},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var d=b(this),f=d.prop("href"),e=d.prop("download"),c="application/octet-stream";d.bind("dragstart",function(g){try{g.originalEvent.dataTransfer.setData("DownloadURL",[c,e,f].join(":"))}catch(h){}})},_formatFileSize:function(c){if(typeof c!=="number"){return""}if(c>=1000000000){return(c/1000000000).toFixed(2)+" GB"}if(c>=1000000){return(c/1000000).toFixed(2)+" MB"}return(c/1000).toFixed(2)+" KB"},_formatBitrate:function(c){if(typeof c!=="number"){return""}if(c>=1000000000){return(c/1000000000).toFixed(2)+" Gbit/s"}if(c>=1000000){return(c/1000000).toFixed(2)+" Mbit/s"}if(c>=1000){return(c/1000).toFixed(2)+" kbit/s"}return c.toFixed(2)+" bit/s"},_formatTime:function(c){var e=new Date(c*1000),d=Math.floor(c/86400);d=d?d+"d ":"";return d+("0"+e.getUTCHours()).slice(-2)+":"+("0"+e.getUTCMinutes()).slice(-2)+":"+("0"+e.getUTCSeconds()).slice(-2)},_formatPercentage:function(c){return(c*100).toFixed(2)+" %"},_renderExtendedProgress:function(c){return this._formatBitrate(c.bitrate)+" | "+this._formatTime((c.total-c.loaded)*8/c.bitrate)+" | "+this._formatPercentage(c.loaded/c.total)+" | "+this._formatFileSize(c.loaded)+" / "+this._formatFileSize(c.total)},_renderTemplate:function(d,c){if(!d){return b()}var e=d({files:c,formatFileSize:this._formatFileSize,options:this.options});if(e instanceof b){return e}return b(this.options.templatesContainer).html(e).children()},_renderPreviews:function(c){c.context.find(".preview").each(function(e,d){b(d).append(c.files[e].preview)})},_renderUpload:function(c){return this._renderTemplate(this.options.uploadTemplate,c)},_renderDownload:function(c){return this._renderTemplate(this.options.downloadTemplate,c).find("a[download]").each(this._enableDragToDesktop).end()},_startHandler:function(d){d.preventDefault();var f=b(d.currentTarget),g=f.closest(".template-upload"),c=g.data("data");f.prop("disabled",true);if(c&&c.submit){c.submit()}},_cancelHandler:function(d){d.preventDefault();var f=b(d.currentTarget).closest(".template-upload,.template-download"),c=f.data("data")||{};c.context=c.context||f;if(c.abort){c.abort()}else{c.errorThrown="abort";this._trigger("fail",d,c)}},_deleteHandler:function(d){d.preventDefault();var c=b(d.currentTarget);this._trigger("destroy",d,b.extend({context:c.closest(".template-download"),type:"DELETE"},c.data()))},_forceReflow:function(c){return b.support.transition&&c.length&&c[0].offsetWidth},_transition:function(d){var c=b.Deferred();if(b.support.transition&&d.hasClass("fade")&&d.is(":visible")){d.bind(b.support.transition.end,function(f){if(f.target===d[0]){d.unbind(b.support.transition.end);c.resolveWith(d)}}).toggleClass("in")}else{d.toggleClass("in");c.resolveWith(d)}return c},_initButtonBarEventHandlers:function(){var c=this.element.find(".fileupload-buttonbar"),d=this.options.filesContainer;this._on(c.find(".start"),{click:function(f){f.preventDefault();d.find(".start").click()}});this._on(c.find(".cancel"),{click:function(f){f.preventDefault();d.find(".cancel").click()}});this._on(c.find(".delete"),{click:function(f){f.preventDefault();d.find(".toggle:checked").closest(".template-download").find(".delete").click();c.find(".toggle").prop("checked",false)}});this._on(c.find(".toggle"),{change:function(f){d.find(".toggle").prop("checked",b(f.currentTarget).is(":checked"))}})},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".start, .cancel, .delete"),"click");this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_initEventHandlers:function(){this._super();this._on(this.options.filesContainer,{"click .start":this._startHandler,"click .cancel":this._cancelHandler,"click .delete":this._deleteHandler});this._initButtonBarEventHandlers()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers();this._off(this.options.filesContainer,"click");this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",false).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",true).parent().addClass("disabled")},_initTemplates:function(){var c=this.options;c.templatesContainer=this.document[0].createElement(c.filesContainer.prop("nodeName"));if(a){if(c.uploadTemplateId){c.uploadTemplate=a(c.uploadTemplateId)}if(c.downloadTemplateId){c.downloadTemplate=a(c.downloadTemplateId)}}},_initFilesContainer:function(){var c=this.options;if(c.filesContainer===undefined){c.filesContainer=this.element.find(".files")}else{if(!(c.filesContainer instanceof b)){c.filesContainer=b(c.filesContainer)}}},_initSpecialOptions:function(){this._super();this._initFilesContainer();this._initTemplates()},_create:function(){this._super();this._resetFinishedDeferreds();if(!b.support.fileInput){this._disableFileInputButton()}},enable:function(){var c=false;if(this.options.disabled){c=true}this._super();if(c){this.element.find("input, button").prop("disabled",false);this._enableFileInputButton()}},disable:function(){if(!this.options.disabled){this.element.find("input, button").prop("disabled",true);this._disableFileInputButton()}this._super()}})}));
